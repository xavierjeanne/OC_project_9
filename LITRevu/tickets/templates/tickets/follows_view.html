{% extends "base.html" %}
{% load widget_tweaks %}
{% block content %}

<div class="flex items-center justify-center w-full min-h-[80vh] px-4">

  <div class="bg-white shadow-xl rounded-2xl p-10 w-full max-w-2xl">
    
    <h1 class="text-4xl font-bold mb-8 text-center text-gray-800">Abonnements</h1>

    <form method="post" class="space-y-6">
      {% csrf_token %}
      {% for field in form %}
        <div>
          {{ field.label_tag}}
          {{ field|add_class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-600 transition" }}
        </div>
      {% endfor %}

      {% if message %}
        <div class="text-red-600 text-sm mt-2">
          <p>{{ message }}</p>
        </div>
      {% endif %}

      <button type="submit" class="cursor-pointer w-full py-3 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition duration-200">
        S'abonner
      </button>
    </form>

    <div class="mt-10 space-y-8">
      
      <div>
        <h3 class="text-xl font-semibold text-gray-800 mb-3">Utilisateurs que vous suivez</h3>
        <ul class="space-y-2">
          {% for relation in following %}
            <li class="flex items-center justify-between bg-gray-100 px-4 py-2 rounded-lg">
              <span class="text-gray-700">{{ relation.followed.username }}</span>
              <form method="post" action="{% url 'unfollow' relation.followed.id %}">
                {% csrf_token %}
                <button type="submit" class="cursor-pointer text-red-600 hover:text-red-800 text-sm font-medium">Se d√©sabonner</button>
              </form>
            </li>
          {% empty %}
            <li class="text-gray-500">Vous ne suivez personne.</li>
          {% endfor %}
        </ul>
      </div>

      <div>
        <h3 class="text-xl font-semibold text-gray-800 mb-3">Utilisateurs qui vous suivent</h3>
        <ul class="space-y-2">
          {% for relation in followers %}
            <li class="bg-gray-50 px-4 py-2 rounded-lg text-gray-700 bg-gray-100 transition duration-200">{{ relation.follower.username }}</li>
          {% empty %}
            <li class="text-gray-500">Personne ne vous suit.</li>
          {% endfor %}
        </ul>
      </div>

    </div>
  </div>

</div>

{% endblock %}
